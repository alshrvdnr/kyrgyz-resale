<!DOCTYPE html>
<html lang="ru">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"
    />
    <title>Кыргызстан Подарки</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
    />
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <div id="app">
      <!-- ГЛАВНАЯ СТРАНИЦА -->
      <section id="page-home" class="page">
        <header class="main-header">
          <div class="search-row">
            <div class="search-bar">
              <i class="fa fa-search"></i>
              <input
                type="text"
                id="main-search"
                placeholder="Ищу подарки..."
                onkeypress="handleSearch(event)"
              />
            </div>
          </div>
          <div class="category-row">
            <div class="cat-chip active" onclick="filterByCat('Все', this)">
              Все
            </div>
            <div class="cat-chip" onclick="filterByCat('flowers', this)">
              Цветы
            </div>
            <div class="cat-chip" onclick="filterByCat('jewelry', this)">
              Ювелирка
            </div>
            <div class="cat-chip" onclick="filterByCat('gifts', this)">
              Подарки
            </div>
            <div class="cat-chip" onclick="filterByCat('certs', this)">
              Сертификаты
            </div>
          </div>
        </header>

        <!-- БЛОК ТАБОВ (Исчезает при пустом поиске) -->
        <div id="home-tabs-container">
          <div class="feed-tabs">
            <div class="feed-tab active" onclick="switchFeed('rec', this)">
              Рекомендуемые
            </div>
            <div class="feed-tab" onclick="switchFeed('new', this)">Новые</div>
          </div>
        </div>

        <!-- СООБЩЕНИЕ ОБ ОШИБКЕ ПОИСКА -->
        <div id="search-error" class="error-container hidden">
          <p>По такому запросу ничего не найдено</p>
        </div>

        <main class="listings-grid" id="home-grid"></main>
      </section>

      <!-- ИЗБРАННОЕ -->
      <section id="page-favs" class="page hidden">
        <header class="page-header-simple">
          <div class="header-content">
            <h2>Избранное</h2>
            <button class="clear-all-btn" onclick="clearFavs()">
              Удалить всё
            </button>
          </div>
          <div class="fav-tabs">
            <div class="f-tab active">Объявления</div>
            <div class="f-tab">Поиски</div>
          </div>
        </header>
        <main class="listings-grid" id="favs-grid"></main>
      </section>

      <!-- ПРОФИЛЬ (УПРОЩЕННЫЙ) -->
      <section id="page-profile" class="page hidden">
        <div class="profile-simple-header">
          <div class="avatar-large" id="u-avatar">?</div>
          <h2 id="u-name">Загрузка...</h2>
        </div>

        <div class="profile-tabs">
          <div class="p-tab active" onclick="switchProfileTab('active', this)">
            Активно
          </div>
          <div class="p-tab" onclick="switchProfileTab('history', this)">
            Проданные / Удаленные
          </div>
        </div>

        <main class="listings-grid" id="my-ads-grid"></main>
      </section>

      <!-- ДОБАВЛЕНИЕ ОБЪЯВЛЕНИЯ -->
      <section id="page-add" class="page hidden">
        <header class="page-header-simple">
          <button onclick="showPage('home')" class="back-icon">✕</button>
          <h2>Новое объявление</h2>
          <span></span>
        </header>
        <div class="form-container">
          <div class="form-group">
            <label>Загрузите фото</label>
            <div
              class="upload-zone"
              onclick="document.getElementById('file-input').click()"
            >
              <i class="fa fa-image"></i>
              <span id="upload-text">Нажмите для выбора фото</span>
              <input
                type="file"
                id="file-input"
                accept="image/*"
                hidden
                onchange="previewFile(this)"
              />
            </div>
            <div id="image-preview-container" class="hidden">
              <img id="image-preview" src="" />
            </div>
          </div>

          <div class="form-group">
            <label>Telegram (никнейм канала без @)</label>
            <input type="text" id="in-tg" placeholder="Напр: my_channel" />
          </div>

          <div class="form-group">
            <label>Номер телефона (WhatsApp / Звонки)</label>
            <input type="tel" id="in-phone" placeholder="996..." />
          </div>

          <div class="form-group">
            <label>Название товара</label>
            <input type="text" id="in-title" placeholder="Что вы продаете?" />
          </div>

          <div class="form-group">
            <label>Цена (KGS)</label>
            <input type="number" id="in-price" placeholder="0" />
          </div>

          <div class="form-group">
            <label>Категория</label>
            <select id="in-cat">
              <option value="flowers">Цветы</option>
              <option value="jewelry">Ювелирка</option>
              <option value="gifts">Подарки</option>
              <option value="certs">Сертификаты</option>
            </select>
          </div>

          <div class="form-group">
            <label>Описание</label>
            <textarea
              id="in-desc"
              placeholder="Расскажите подробнее..."
              rows="4"
            ></textarea>
          </div>

          <button class="btn-publish" onclick="submitAd()">Опубликовать</button>
        </div>
      </section>

      <!-- ПРОСМОТР ТОВАРА -->
      <div id="product-modal" class="product-modal hidden">
        <button class="modal-close-btn" onclick="closeProduct()">✕</button>
        <div id="product-details"></div>
        <div class="product-footer" id="product-footer">
          <!-- Сюда вставится кнопка "Написать" -->
        </div>
      </div>

      <!-- НАВИГАЦИЯ (3 ВКЛАДКИ) -->
      <nav class="bottom-nav">
        <button class="nav-item active" onclick="showPage('home')" id="n-home">
          <i class="fa fa-home"></i><span>Главная</span>
        </button>
        <div class="center-nav-item">
          <button class="add-btn-pink" onclick="showPage('add')">+</button>
        </div>
        <button class="nav-item" onclick="showPage('favs')" id="n-favs">
          <i class="fa fa-heart"></i><span>Избранное</span>
        </button>
        <button class="nav-item" onclick="showPage('profile')" id="n-profile">
          <i class="fa fa-user"></i><span>Профиль</span>
        </button>
      </nav>
    </div>
    <script src="app.js"></script>
  </body>
</html>
