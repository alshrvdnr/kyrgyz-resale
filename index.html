<!DOCTYPE html>
<html lang="ru">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"
    />
    <title>Кыргызстан Подарки</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
    />
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <div id="app">
      <!-- ГЛАВНАЯ -->
      <section id="page-home" class="page">
        <header class="main-header">
          <!-- Верхняя часть: Геолокация -->
          <div class="top-location-bar" onclick="changeCity()">
            <div class="location-text">
              <i class="fa-solid fa-location-dot"></i>
              <span id="current-city-label">Бишкек</span>
              <i
                class="fa-solid fa-chevron-right"
                style="font-size: 10px; margin-left: 4px"
              ></i>
            </div>
          </div>

          <!-- Поле поиска и Аватар -->
          <div class="search-profile-row">
            <div class="search-wrapper">
              <i class="fa fa-search"></i>
              <input
                type="text"
                id="main-search"
                placeholder="Поиск цветов..."
                onkeypress="handleSearch(event)"
              />
            </div>
            <div
              class="user-avatar-circle"
              id="u-avatar-top"
              onclick="showPage('profile')"
            >
              ?
            </div>
          </div>

          <!-- Разделы категорий -->
          <div class="categories-container">
            <div
              class="cat-card active"
              id="cat-flowers"
              onclick="filterByCat('flowers', this)"
            >
              <div class="cat-icon-box">
                <i class="fa-solid fa-box-open"></i>
              </div>
              <span>Цветы</span>
            </div>
            <div
              class="cat-card"
              id="cat-gifts"
              onclick="filterByCat('gifts', this)"
            >
              <div class="cat-icon-box"><i class="fa-solid fa-gift"></i></div>
              <span>Подарки</span>
            </div>
            <div
              class="cat-card"
              id="cat-jewelry"
              onclick="filterByCat('jewelry', this)"
            >
              <div class="cat-icon-box"><i class="fa-solid fa-ring"></i></div>
              <span>Ювелирка</span>
            </div>
            <div
              class="cat-card"
              id="cat-certs"
              onclick="filterByCat('certs', this)"
            >
              <div class="cat-icon-box"><i class="fa-solid fa-ticket"></i></div>
              <span>Сертификаты</span>
            </div>
          </div>
        </header>

        <div id="home-content-area">
          <h2 class="section-title-main" id="dynamic-feed-title">
            Свежие букеты
          </h2>
          <main class="listings-grid" id="home-grid"></main>
        </div>

        <div id="search-error" class="error-container hidden">
          <p>Ничего не найдено</p>
        </div>
      </section>

      <!-- СТРАНИЦА РЕЗУЛЬТАТОВ -->
      <section id="page-results" class="page hidden">
        <header class="results-header">
          <button class="back-circle-btn" onclick="showPage('home')">
            <i class="fa fa-arrow-left"></i>
          </button>
          <h2>Результаты</h2>
          <span style="width: 24px"></span>
        </header>
        <div style="padding-top: 10px">
          <main class="listings-grid" id="results-grid"></main>
        </div>
      </section>

      <!-- ИЗБРАННОЕ -->
      <section id="page-favs" class="page hidden">
        <header class="favs-header-custom">
          <div class="favs-top-line">
            <span style="width: 60px"></span>
            <h2>Избранное</h2>
            <button class="favs-clear-link" onclick="clearFavs()">
              Очистить
            </button>
          </div>
        </header>
        <main id="favs-content-area"></main>
      </section>

      <!-- ПРОФИЛЬ -->
      <section id="page-profile" class="page hidden">
        <div class="profile-hero">
          <div class="avatar-circle" id="u-avatar-big">?</div>
          <h2 id="u-name">Загрузка...</h2>
        </div>
        <div class="profile-tabs-nav">
          <div
            class="p-tab active"
            id="p-tab-active"
            onclick="switchProfileTab('active')"
          >
            Активные
          </div>
          <div class="p-tab" id="p-tab-sold" onclick="switchProfileTab('sold')">
            Архив
          </div>
        </div>
        <main class="listings-grid" id="my-ads-grid"></main>
      </section>

      <!-- ПОДАТЬ ОБЪЯВЛЕНИЕ -->
      <section id="page-add" class="page hidden">
        <header class="page-header-simple">
          <button onclick="cancelAdd()" class="close-circle-btn">
            <i class="fa fa-times"></i>
          </button>
          <h2 id="add-title-text">Новое объявление</h2>
          <span></span>
        </header>
        <div class="form-scroll">
          <div class="tariff-container" id="tariff-selection-area">
            <div
              class="tariff-card active"
              id="tariff-std"
              onclick="selectTariff('standard')"
            >
              <div class="tariff-title">Стандарт</div>
              <div class="tariff-price">Бесплатно</div>
            </div>
            <div
              class="tariff-card"
              id="tariff-vip"
              onclick="selectTariff('vip')"
            >
              <div class="tariff-title vip-gold-text">VIP</div>
              <div class="tariff-price">100 сом</div>
            </div>
          </div>

          <div id="vip-block" class="hidden vip-details">
            <div class="tariff-title vip-gold-text">VIP размещение</div>
            <p style="font-size: 12px; color: gray; margin-bottom: 10px">
              Объявление будет в топе 3 дня.
            </p>
            <div class="qr-placeholder">
              <!-- Твой QR код -->
              <img
                src="https://i.ibb.co/v487YmS6/photo-2025-02-18-19-14-11.jpg"
                style="width: 100%; border-radius: 10px"
              />
            </div>
            <div
              class="upload-zone"
              style="padding: 15px; border-color: var(--vip-gold)"
              onclick="document.getElementById('receipt-input').click()"
            >
              <i
                class="fa fa-file-invoice-dollar"
                style="color: var(--vip-gold)"
              ></i>
              <span id="receipt-label" style="color: white; font-size: 13px"
                >Добавить чек</span
              >
              <input
                type="file"
                id="receipt-input"
                accept="image/*"
                hidden
                onchange="handleReceiptSelect(this)"
              />
            </div>
          </div>

          <div class="f-group">
            <label>Фотографии (до 5 шт)</label>
            <div
              class="upload-zone"
              onclick="document.getElementById('file-input').click()"
            >
              <i class="fa fa-camera"></i>
              <span id="file-label">Нажмите для выбора фото</span>
              <input
                type="file"
                id="file-input"
                accept="image/*"
                multiple
                hidden
                onchange="handleFileSelect(this)"
              />
            </div>
            <div id="preview-box" class="hidden">
              <div id="gallery-preview" class="upload-gallery"></div>
              <p
                style="
                  font-size: 12px;
                  color: gray;
                  text-align: center;
                  margin-top: 5px;
                "
              >
                Выбрано: <span id="photo-count">0</span>
              </p>
            </div>
          </div>

          <div class="f-group">
            <label>Отдел (Категория)</label>
            <select id="in-cat" class="main-input">
              <option value="flowers">Цветы</option>
              <option value="jewelry">Ювелирка</option>
              <option value="gifts">Подарки</option>
              <option value="certs">Сертификаты</option>
            </select>
          </div>

          <div class="f-group">
            <label>Дата получения</label
            ><input type="date" id="in-date" class="main-input" />
          </div>
          <div class="f-group">
            <label>Город</label>
            <select id="in-city" class="main-input">
              <option value="Бишкек">Бишкек</option>
              <option value="Ош">Ош</option>
              <option value="Манас">Манас</option>
              <option value="Токмок">Токмок</option>
              <option value="Каракол">Каракол</option>
            </select>
          </div>
          <div class="f-group">
            <label>Адрес</label
            ><input
              type="text"
              id="in-address"
              class="main-input"
              placeholder="Улица, дом"
            />
          </div>
          <div class="f-group">
            <label>Telegram ник (без собачки)</label
            ><input
              type="text"
              id="in-tg"
              class="main-input"
              placeholder="username"
            />
          </div>
          <div class="f-group">
            <label>Телефон</label
            ><input
              type="tel"
              id="in-wa"
              class="main-input"
              placeholder="996..."
            />
          </div>
          <div class="f-group">
            <label>Название товара</label
            ><input
              type="text"
              id="in-title"
              class="main-input"
              placeholder="Например: 101 Роза"
            />
          </div>
          <div class="f-group">
            <label>Цена (KGS)</label
            ><input
              type="number"
              id="in-price"
              class="main-input"
              placeholder="0"
            />
          </div>
          <div class="f-group">
            <label>Описание (необязательно)</label
            ><textarea
              id="in-desc"
              class="main-input"
              placeholder="Детали..."
            ></textarea>
          </div>

          <button
            class="pink-btn-full"
            id="publish-btn"
            onclick="publishAndSend()"
          >
            Опубликовать
          </button>
        </div>
      </section>

      <!-- ФИЛЬТР -->
      <section id="page-filter" class="page hidden">
        <header class="filter-header">
          <button class="filter-close" onclick="showPage('home')">✕</button>
          <h2>Фильтр</h2>
          <button class="filter-reset" onclick="resetExtendedFilter()">
            Очистить
          </button>
        </header>

        <div class="filter-body">
          <div class="filter-section">
            <label class="filter-label">Категория</label>
            <select id="ext-cat" class="filter-select">
              <option value="Все">Выбрать</option>
              <option value="flowers">Цветы</option>
              <option value="jewelry">Ювелирка</option>
              <option value="gifts">Подарки</option>
              <option value="certs">Сертификаты</option>
            </select>
          </div>

          <div class="filter-section">
            <label class="filter-label">Местоположение</label>
            <select id="ext-city" class="filter-select">
              <option value="Все">Кыргызстан (Все)</option>
              <option value="Бишкек">Бишкек</option>
              <option value="Ош">Ош</option>
              <option value="Манас">Манас</option>
              <option value="Токмок">Токмок</option>
              <option value="Каракол">Каракол</option>
            </select>
          </div>

          <div class="filter-section">
            <label class="filter-label">Цена (KGS)</label>
            <div class="price-row">
              <input
                type="number"
                id="price-from"
                class="price-input"
                placeholder="От 0"
              />
              <input
                type="number"
                id="price-to"
                class="price-input"
                placeholder="До ..."
              />
            </div>
          </div>

          <div class="filter-section">
            <label class="filter-label">Сортировать</label>
            <label class="sort-option">
              <span class="sort-label">По умолчанию</span>
              <input
                type="radio"
                name="sort"
                value="default"
                class="sort-input"
                checked
              />
              <div class="custom-radio"></div>
            </label>
            <label class="sort-option">
              <span class="sort-label">Сначала дешевле</span>
              <input
                type="radio"
                name="sort"
                value="cheap"
                class="sort-input"
              />
              <div class="custom-radio"></div>
            </label>
            <label class="sort-option">
              <span class="sort-label">Сначала дороже</span>
              <input
                type="radio"
                name="sort"
                value="expensive"
                class="sort-input"
              />
              <div class="custom-radio"></div>
            </label>
          </div>
        </div>

        <div class="filter-bottom-fixed">
          <button class="green-btn" onclick="applyExtendedFilter()">
            Показать результаты
          </button>
        </div>
      </section>

      <!-- МОДАЛКА -->
      <div id="product-modal" class="full-view hidden">
        <div class="pv-header">
          <button class="pv-back" onclick="closeProduct()">
            <i class="fa fa-chevron-left"></i>
          </button>
          <div class="pv-top-icons" id="modal-fav-icon"></div>
        </div>
        <div id="pv-content" class="pv-scroll-area"></div>
      </div>

      <!-- НАВИГАЦИЯ -->
      <nav class="bottom-nav">
        <button class="nav-item active" onclick="showPage('home')" id="n-home">
          <i class="fa-solid fa-house"></i><span>Главная</span>
        </button>
        <div class="nav-center">
          <button class="pink-plus-main" onclick="showPage('add')">
            <i class="fa-solid fa-plus"></i>
          </button>
          <p>Подать</p>
        </div>
        <button class="nav-item" onclick="showPage('favs')" id="n-favs">
          <i class="fa-solid fa-heart"></i><span>Избранное</span>
        </button>
      </nav>
    </div>
    <script src="app.js"></script>
  </body>
</html>
