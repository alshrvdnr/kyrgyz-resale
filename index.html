<!DOCTYPE html>
<html lang="ru">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"
    />
    <title>Gifts KG</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
    />
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <div id="app">
      <section id="page-home" class="page">
        <header class="main-header">
          <div class="search-row">
            <div class="search-bar">
              <i class="fa fa-search"></i
              ><input
                type="text"
                placeholder="Я ищу..."
                onkeypress="handleSearch(event)"
              />
            </div>
            <button class="filter-pink-btn" onclick="showPage('filter')">
              Фильтр
            </button>
          </div>
          <div class="category-row">
            <div class="cat-chip active" onclick="filterByCat('Все', this)">
              Все
            </div>
            <div class="cat-chip" onclick="filterByCat('flowers', this)">
              Цветы
            </div>
            <div class="cat-chip" onclick="filterByCat('jewelry', this)">
              Ювелирка
            </div>
            <div class="cat-chip" onclick="filterByCat('gifts', this)">
              Подарки
            </div>
            <div class="cat-chip" onclick="filterByCat('certs', this)">
              Сертификаты
            </div>
          </div>
        </header>
        <div class="capsule-container">
          <div class="capsule-tabs">
            <div
              class="cap-tab active"
              id="mtab-rec"
              onclick="switchMainTab('rec')"
            >
              Рекомендуемые
            </div>
            <div class="cap-tab" id="mtab-new" onclick="switchMainTab('new')">
              Новые
            </div>
          </div>
        </div>
        <main class="listings-grid" id="home-grid"></main>
      </section>

      <section id="page-filter" class="page hidden">
        <header class="filter-header">
          <button class="filter-close" onclick="showPage('home')">✕</button>
          <h2>Фильтр</h2>
          <button class="filter-reset" onclick="resetExtendedFilter()">
            Очистить
          </button>
        </header>
        <div class="filter-body">
          <label class="filter-label">Категория</label>
          <select id="ext-cat" class="filter-select">
            <option value="Все">Все категории</option>
            <option value="flowers">Цветы</option>
            <option value="jewelry">Ювелирка</option>
            <option value="gifts">Подарки</option>
            <option value="certs">Сертификаты</option>
          </select>
          <label class="filter-label">Город</label>
          <select id="ext-city" class="filter-select">
            <option value="Все">Весь Кыргызстан</option>
            <option value="Бишкек">Бишкек</option>
            <option value="Ош">Ош</option>
          </select>
          <label class="filter-label">Цена (KGS)</label>
          <div class="price-row">
            <input
              type="number"
              id="price-from"
              class="price-input"
              placeholder="От"
            />
            <input
              type="number"
              id="price-to"
              class="price-input"
              placeholder="До"
            />
          </div>
          <label class="filter-label">Сортировка</label>
          <div class="sort-list">
            <label class="sort-option"
              >Сначала новые
              <input type="radio" name="sort" value="default" checked
            /></label>
            <label class="sort-option"
              >Сначала дешевые <input type="radio" name="sort" value="cheap"
            /></label>
            <label class="sort-option"
              >Сначала дорогие
              <input type="radio" name="sort" value="expensive"
            /></label>
          </div>
        </div>
        <div class="filter-bottom-fixed">
          <button class="green-btn" onclick="applyExtendedFilter()">
            Показать результаты
          </button>
        </div>
      </section>

      <section id="page-results" class="page hidden">
        <header class="results-header">
          <button onclick="showPage('home')">
            <i class="fa fa-arrow-left"></i>
          </button>
          <h2>Результаты</h2>
          <span></span>
        </header>
        <main class="listings-grid" id="results-grid"></main>
      </section>

      <section id="page-add" class="page hidden">
        <header class="page-header-simple"><h2>Новое объявление</h2></header>
        <div class="form-scroll">
          <div class="tariff-container">
            <div
              class="tariff-card active"
              id="tariff-std"
              onclick="selectTariff('standard')"
            >
              Стандарт
            </div>
            <div
              class="tariff-card"
              id="tariff-vip"
              onclick="selectTariff('vip')"
            >
              VIP (100 сом)
            </div>
          </div>
          <div id="vip-block" class="hidden vip-details">
            <p>Оплата через QR (3 дня в топе)</p>
            <div class="qr-placeholder">
              <img
                src="https://api.qrserver.com/v1/create-qr-code/?size=120x120&data=PAY"
              />
            </div>
            <button
              class="btn-mini"
              onclick="document.getElementById('receipt-input').click()"
              id="receipt-label"
            >
              Добавить чек
            </button>
            <input
              type="file"
              id="receipt-input"
              hidden
              onchange="handleReceiptSelect(this)"
            />
          </div>
          <div class="f-group">
            <label>Фото (до 5)</label>
            <div
              class="upload-zone"
              onclick="document.getElementById('file-input').click()"
              id="file-label"
            >
              Выбрать фото
            </div>
            <input
              type="file"
              id="file-input"
              multiple
              hidden
              onchange="handleFileSelect(this)"
            />
            <div id="preview-box" class="hidden">
              <div id="gallery-preview" class="upload-gallery"></div>
            </div>
          </div>
          <input
            type="text"
            id="in-title"
            class="main-input"
            placeholder="Название"
          />
          <input
            type="number"
            id="in-price"
            class="main-input"
            placeholder="Цена KGS"
          />
          <input type="date" id="in-date" class="main-input" />
          <select id="in-city" class="main-input">
            <option value="Бишкек">Бишкек</option>
            <option value="Ош">Ош</option>
          </select>
          <select id="in-cat" class="main-input">
            <option value="flowers">Цветы</option>
            <option value="jewelry">Ювелирка</option>
          </select>
          <input
            type="text"
            id="in-address"
            class="main-input"
            placeholder="Адрес"
          />
          <input
            type="text"
            id="in-tg"
            class="main-input"
            placeholder="Telegram (без @)"
          />
          <input
            type="tel"
            id="in-wa"
            class="main-input"
            placeholder="Телефон"
          />
          <textarea
            id="in-desc"
            class="main-input"
            placeholder="Описание"
          ></textarea>
          <button class="pink-btn-full" onclick="publishAndSend()">
            Опубликовать
          </button>
        </div>
      </section>

      <section id="page-favs" class="page hidden">
        <header class="results-header">
          <h2>Избранное</h2>
          <button onclick="clearFavs()">Очистить</button>
        </header>
        <main id="favs-content-area"></main>
      </section>

      <section id="page-profile" class="page hidden">
        <div class="profile-hero">
          <div class="avatar-circle" id="u-avatar">?</div>
          <h2 id="u-name">Загрузка</h2>
        </div>
        <div class="profile-tabs-nav">
          <div
            class="p-tab active"
            id="p-tab-active"
            onclick="switchProfileTab('active')"
          >
            Активные
          </div>
          <div class="p-tab" id="p-tab-sold" onclick="switchProfileTab('sold')">
            Архив
          </div>
        </div>
        <main class="listings-grid" id="my-ads-grid"></main>
      </section>

      <div id="product-modal" class="full-view hidden">
        <div class="pv-header">
          <button class="pv-back" onclick="closeProduct()">✕</button>
          <div id="modal-fav-icon"></div>
        </div>
        <div id="pv-content"></div>
      </div>

      <nav class="bottom-nav">
        <button class="nav-item active" onclick="showPage('home')" id="n-home">
          <i class="fa fa-home"></i>
        </button>
        <div class="nav-center">
          <button class="pink-plus" onclick="showPage('add')">+</button>
        </div>
        <button class="nav-item" onclick="showPage('favs')" id="n-favs">
          <i class="fa fa-heart"></i>
        </button>
        <button class="nav-item" onclick="showPage('profile')" id="n-profile">
          <i class="fa fa-user"></i>
        </button>
      </nav>
    </div>
    <script src="app.js"></script>
  </body>
</html>
